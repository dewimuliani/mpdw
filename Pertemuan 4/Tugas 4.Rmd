---
title: "Tugas 4"
author: "Dewi Muliani"
date: "2025-09-21"
output: html_document
---

# White Noise

```{r}
set.seed(1234)
wn <- rnorm(300)
ts.plot(wn)
```

# MA(2)
## Pembangkitan Proses MA(2)

```{r}
set.seed(1234)
# Menginisialisasi vektor hasil untuk menyediakan wadah (vektor kosong) agar hasil perhitungan MA(2) bisa langsung disimpan tanpa error indexing.
ma2 <- rep(0, 300)

# Menghitung nilai pertama (t=1)
ma2[1] <- wn[1] + 0.4*0 + 0.6*0

# Menghitung nilai kedua (t=2)
ma2[2] <- wn[2] + 0.4*wn[1] + 0.6*0
```

$$
y_t = e_t+0.4e_{t-1}+0.6e_{t-2}
$$

### Manual

```{r}
# Loop untuk menghasilkan data MA(2)
for(i in 3:300){
  ma2[i] <- wn[i] + 0.4*wn[i-1] + 0.6*wn[i-2]
}

ma2
```

### Dengan arima.sim
```{r}
set.seed(1234)
ma2_sim <- arima.sim(list(order=c(0,0,2), ma=c(0.4,0.6)), n=300)
ma2_sim
```

Hasil dari pembangkitan MA(2) dengan cara manual (looping) dan dengan arima.sim berbeda karena pada metode manual biasanya nilai awal white noise sebelum observasi pertama dianggap nol, sedangkan arima.sim menggunakan mekanisme internal dengan white noise tambahan (burn-in) sehingga perlakuan nilai awal berbeda. Selain itu, white noise yang digunakan juga tidak sama, sehingga meskipun keduanya mengikuti model MA(2) dengan parameter identik, realisasi data yang dihasilkan berbeda. Namun, secara teori keduanya tetap memiliki sifat statistik yang sama, seperti rata-rata nol, varians konstan, dan ACF yang terpotong pada lag ke-2.

## Karakteristik MA(2)

### Plot

#### Plot Time Series

```{r}
ts.plot(ma2)
```

Berdasarkan plot time series, terlihat bahwa data MA(1) yang dibangkitkan stasioner dalam rataan

#### Plot ACF

```{r}
acf(ma2,lag.max = 20)
```

Berdasarkan plot AFC tersebut, terlihat bahwa plot ACF cut-off di lag kedua.

#### Plot PACF

```{r}
pacf(ma2)
```

Berdasarkan plot PACF tersebut, terlihat bahwa plot PACF cenderung *tails off*.

#### Plot EACF

```{r}
TSA::eacf(ma2)
```

Berdasarkan pola segitiga nol pada plot EACF, terlihat bahwa segitiga nol berada pada ordo AR(0) dan ordo MA(2)

Berdasarkan plot time series dapat disimpulkan bahwa data tersebut stasioner, baik dari sisi rataan maupun ragam. Plot ACF, PACF, dan EACF juga mendukung identifikasi bahwa proses ini sesuai dengan model MA(2).

### Scatterplot Antar Lag

#### Korelasi antara $Y_t$ dengan $Y_{t-1}$

```{r}
#Yt
yt_ma2 <- ma2[-1]
yt_ma2
#Yt-1
yt_1_ma2 <- ma2[-300]
yt_1_ma2

plot(y=yt_ma2,x=yt_1_ma2)
```

Berdasarkan scatterplot tersebut, terlihat bahwa terdapat hubungan positif antara $Y_t$ dengan $Y_{t-1}$. Hal ini sesuai dengan teori yang ada

```{r}
cor(yt_ma2,yt_1_ma2)
```

Korelasi antara $Y_t$ dengan $Y_{t-1}$ dari hasil simulasi mendekati perhitungan teoritis yaitu

$$
\rho_1=\frac{\theta_1 +\theta_1\theta_2}{1+\theta_1^2+\theta_2^2}=\frac{0.4+(0.4)(0.6)}{1+(0.4)^2+(0.6)^2}=\frac{0.64}{1.52}=0.42
$$

#### Korelasi antara $Y_t$ dengan $Y_{t-2}$

```{r}
#Yt
yt_ma2 <- ma2[-c(1,2)]
yt_ma2
#Yt-2
yt_2_ma2 <- ma2[-c(299,300)]
yt_2_ma2
```

```{r}
plot(y=yt_ma2,x=yt_2_ma2)
```

Berdasarkan scatterplot tersebut, terlihat bahwa terdapat hubungan positif antara $Y_t$ dengan $Y_{t-2}$ namun tidak sekuat hubungan antara $Y_t$ dengan $Y_{t-1}$. Hal ini sesuai dengan teori MA(2)

```{r}
cor(yt_ma2,yt_2_ma2)
```
Korelasi antara $Y_t$ dengan $Y_{t-2}$ dari hasil simulasi mendekati perhitungan teoritis yaitu

$$
\rho_1=\frac{\theta_2^2}{1+\theta_1^2+\theta_2^2}=\frac{(0.6)}{1+(0.4)^2+(0.6)^2}=\frac{0.6}{1.52}=0.3947
$$

#### Korelasi antara $Y_t$ dengan $Y_{t-3}$
```{r}
#Yt
yt_ma2 <- ma2[-c(1,2,3)]
yt_ma2
#Yt-2
yt_3_ma2 <- ma2[-c(298,299,300)]
yt_3_ma2

plot(y=yt_ma2,x=yt_3_ma2)
```

Berdasarkan scatterplot tersebut, terlihat bahwa cenderung tidak terdapat hubungan antara $Y_t$ dengan $Y_{t-3}$.

```{r}
cor(yt_ma2,yt_3_ma2)
```

Korelasi antara $Y_t$ dengan $Y_{t-3}$ hasil simulasi mendekati teori yang ada yaitu 0.

# AR(2)
## Pembangkitan Proses AR(2)
```{r}
set.seed(1234)
wn <- rnorm(300)
```

$$ Y_t = e_t+0.5Y_{t-1}+0.2Y_{t-2} $$

```{r}
n <- length(wn) 

# Menginisialisasi nilai awal
ar[1] <- wn[1]
ar[2] <- wn[2] + 0.5*ar[1]
```

### Manual
```{r}
ar <- c(1:n) 
for (i in 3:n) {ar[i]<-wn[i]+0.5*ar[i-1]+0.2*ar[i-2]}
ar
```

### Dengan arima.sim
```{r}
ar2 <- arima.sim(list(order=c(2,0,0), ar = c(0.5, 0.2)), n=300)
ar2
```
Hasil pembangkitan AR(2) secara manual dan dengan fungsi arima.sim() juga berbeda karena keduanya menggunakan white noise acak yang tidak sama, serta perbedaan perlakuan nilai awal. Pada metode manual, nilai awal ditentukan secara eksplisit lalu dilanjutkan dengan rumus rekursif, sedangkan arima.sim() menetapkan kondisi awal berdasarkan sifat stasioner proses AR. Akibatnya, meskipun parameter model sama, keluaran yang dihasilkan tidak identik.

## Karakteristik AR(2)
### Plot 
#### Plot Time Series
```{r}
ts.plot(ar)
```

Berdasarkan plot time series tersebut terlihat bahwa data cenderung stasioner pada rataan

#### Plot ACF
```{r}
acf(ar)
```

Berdasarkan plot ACF tersebut terlihat bahwa plot ACF cenderung *tails off*.

#### Plot PACF
```{r}
pacf(ar)
```

Berdasarkan plot PACF tersebut, terlihat bahwa plot PACF *cuts off* pada lag kedua, sejalan dengan teori yang ada.

#### Plot EACF
```{r}
TSA::eacf(ar)
```

Berdasarkan pola segitiga nol pada plot EACF, terlihat bahwa segitiga nol berada pada ordo AR(1) dan ordo MA(1)

Pada data yang sebenarnya dibangkitkan dari AR(2), EACF bisa saja menampilkan pola seolah cocok dengan ARMA(1,1) karena sifat metode ini yang tidak selalu konsisten. Hal ini umumnya disebabkan oleh beberapa faktor: ukuran sampel yang terbatas sehingga pola korelasi tidak tampak jelas, adanya fluktuasi acak dari white noise yang membuat estimasi korelasi menyimpang, serta kecenderungan EACF “mengganti” orde AR dengan tambahan komponen MA kecil. Akibatnya, meskipun model sebenarnya AR(2), hasil EACF dapat memberi ilusi bahwa model yang sesuai adalah ARMA(1,1).

### Scatterplot Antar Lag
#### Korelasi antara $Y_t$ dengan $Y_{t-1}$
```{r}
#Yt
yt_ar <- ar[-1]
yt_ar
#Yt-1
yt_1_ar <- ar[-300]
yt_1_ar
```

```{r}
plot(y=yt_ar,x=yt_1_ar)
```

Berdasarkan scatterplot tersebut, terlihat bahwa terdapat hubungan positif antara $Y_t$ dengan $Y_{t-1}$. Hal ini sesuai dengan teori yang ada

```{r}
cor(yt_ar,yt_1_ar)
```
Korelasi antara $Y_t$ dengan $Y_{t-1}$ dari hasil simulasi mendekati perhitungan teoritis yaitu $\rho_1=\frac{\phi_1}{1-\phi_2}=\frac{0.5}{1-0.2}=0.625$

#### Korelasi antara $Y_t$ dengan $Y_{t-2}$

```{r}
#Yt
yt_ar2 <- ar[-c(1,2)]
yt_ar2
#Yt-2
yt_2_ar <- ar[-c(299,300)]
yt_2_ar
```

```{r}
plot(y=yt_ar2,x=yt_2_ar)
```

Berdasarkan scatterplot tersebut, terlihat bahwa terdapat hubungan positif antara $Y_t$ dengan $Y_{t-2}$. Hal ini sesuai dengan teori yang ada

```{r}
cor(yt_ar2,yt_2_ar)
```

Korelasi antara $Y_t$ dengan $Y_{t-2}$ dari hasil simulasi mendekati perhitungan teoritis yaitu $\rho_2={\phi_1}{\rho_1}+{\phi_2}{\rho_0}={0.5}(0.625)+0.2(1)=0.5125$

#### Korelasi antara $Y_t$ dengan $Y_{t-3}$
```{r}
#Yt
yt_ar2 <- ar[-c(1,2,3)]
yt_ar2
#Yt-2
yt_3_ar <- ar[-c(298,299,300)]
yt_3_ar
```

```{r}
plot(y=yt_ar2,x=yt_3_ar)
```

Berdasarkan scatterplot tersebut, terlihat bahwa terdapat hubungan positif antara $Y_t$ dengan $Y_{t-3}$. Hal ini sesuai dengan teori yang ada

```{r}
cor(yt_ar2,yt_3_ar)
```

Korelasi antara $Y_t$ dengan $Y_{t-3}$ dari hasil simulasi mendekati perhitungan teoritis yaitu $\rho_3={\phi_1}{\rho_2}+{\phi_2}{\rho_1}={0.5}(0.5125)+0.2(0.625)=0.38125$

# ARMA(2,2)
## Pembangkitan Proses ARMA(2,2
```{r}
set.seed(1234)
n <- 300

# Parameter AR dan MA
phi1 <- 0.5
phi2 <- 0.2
theta1 <- 0.4
theta2 <- 0.6

# White noise
wn <- rnorm(n)

# Menginisialisasi vektor Y
y.arma <- rep(0, n)
```

### Manual
```{r}
# Loop mulai dari t = 3
for (i in 3:n) {
  y.arma[i] <- phi1 * y.arma[i-1] + 
               phi2 * y.arma[i-2] + 
               wn[i] + 
               theta1 * wn[i-1] + 
               theta2 * wn[i-2]
}


y.arma
```

### Dengan arima.sim
```{r}
set.seed(1234)
arma22 <- arima.sim(list(order=c(2,0,2), ar = c(0.5,0.2), ma = c(0.4,0.6)), n=300)
arma22
```
## Karakteristik ARMA(2,2)
### Plot
#### Plot Time series
```{r}
ts.plot(y.arma)
```

Berdasarkan plot time series tersebut, terlihat bahwa model ARMA(2,2) cenderung stasioner dalam rataan

#### Plot ACF
```{r}
acf(y.arma)
```

Berdasarkan plot ACF tersebut, terlihat bahwa model ARMA(2,2) hasil simulasi memiliki plot ACF yang *tails off*, sesuai dengan teori yang ada.

#### Plot PACF
```{r}
pacf(y.arma)
```

Berdasarkan plot PACF tersebut, terlihat bahwa model ARMA(2,2) hasil simulasi memiliki plot PACF yang *tails off*, sesuai dengan teori

#### Plot EACF
```{r}
TSA::eacf(y.arma)
```
Berdasarkan pola segitiga nol pada plot EACF, terlihat bahwa segitiga nol berada pada ordo AR(1) dan ordo MA(2).

Perbedaan antara model sebenarnya ARMA(2,2) dan hasil identifikasi EACF yang terlihat seperti ARMA(1,2) bisa terjadi karena keterbatasan metode dan sifat data simulasi. EACF bekerja dengan mendeteksi pola nol pada fungsi autokorelasi, namun pada sampel terbatas pola ini sering tidak muncul dengan jelas akibat variasi acak dari white noise. Selain itu, kombinasi nilai parameter tertentu bisa membuat struktur korelasi ARMA(2,2) menyerupai ARMA(1,2), sehingga metode cenderung “menyederhanakan” orde AR. Inilah sebabnya hasil EACF dapat berbeda dari model pembangkit aslinya.

### Scatterplot Antar Lag
#### Korelasi antara $Y_t$ dengan $Y_{t-1}$
```{r}
#Yt
yt_arma <- arma22[-1]
yt_arma
#Yt-1
yt_1_arma <- arma22[-300]
yt_1_arma
```

```{r}
plot(y=yt_arma,x=yt_1_arma)
```

Berdasarkan scatterplot tersebut, terlihat bahwa terdapat hubungan positif antara $Y_t$ dengan $Y_{t-1}$. Hal ini sesuai dengan teori yang ada

```{r}
cor(yt_arma,yt_1_arma)
```
Korelasi antara $Y_t$ dengan $Y_{t-1}$ dari hasil simulasi mendekati perhitungan teoritis.
$$
\gamma_0 = \frac{\sigma^2 \bigl(1 + \theta_1^2 + \theta_2^2 + 2\theta_1 + 2\theta_1 \theta_2\bigr)}
{1 - \phi_1^2 - \phi_2^2 - 2\phi_1 \phi_2}=\frac{1 \bigl(1 + 0.4^2 + 0.6^2 + 2(0.4) + 2(0.4)(0.6)\bigr)}
{1 - 0.5^2 - 0.2^2 - 2(0.5)(0.2)}
= 3.7083
$$

$$
\gamma_1 = \phi_1 \gamma_0 + \phi_2 \gamma_1 + \sigma^2 (\theta_1 + \theta_1 \theta_2 + \theta_2)= \frac{0.5(3.7083) + (0.4 + 0.4(0.6) + 0.6)}
{1 - 0.2}
= 3.3064
$$

$$
\rho_1 = 
\frac{\gamma_1}{\gamma_0}
= 0.8918
$$
#### Korelasi antara $Y_t$ dengan $Y_{t-2}$
```{r}
yt_arma <- arma22[-c(1,2)]
yt_2_arma <- arma22[-c(299,300)]
```

```{r}
plot(y=yt_arma,x=yt_2_arma)
```

Berdasarkan scatterplot tersebut, terlihat bahwa terdapat hubungan positif antara $_Y_t$ dengan $_Y_{t−2}$. Hal ini sesuai dengan teori yang ada

```{r}
cor(yt_arma,yt_2_arma)
```

Korelasi antara $Y_t$ dengan $Y_{t−2}$ dari hasil simulasi mendekati perhitungan teoritis.

$$
\gamma_2 = \phi_1 \gamma_1 + \phi_2 \gamma_0 + 
\sigma^2 \bigl(\theta_2 + \phi_1 \theta_1\bigr)
$$

$$
\gamma_2 = 
0.5(3.3064) + 0.2(3.7083) + (0.6 + 0.5(0.4))
= 1.6532 + 0.7417 + 0.8 = 3.1949
$$

$$
\rho_2 = \frac{\gamma_2}{\gamma_0}=\frac{3.1949}{3.7083} = 0.8619
$$

#### Korelasi antara $Y_t$ dengan $Y_{t-3}$
```{r}
yt_arma <- arma22[-c(1,2,3)]
yt_3_arma <- arma22[-c(298,299,300)]
```

```{r}
plot(y=yt_arma,x=yt_3_arma)
```

Berdasarkan scatterplot tersebut, terlihat bahwa terdapat hubungan positif antara $_Y_t$ dengan $Y_{t−3}$. Hal ini sesuai dengan teori yang ada

```{r}
cor(yt_arma,yt_3_arma)
```
Korelasi antara $Y_t$ dengan $Y_{t−2}$ dari hasil simulasi mendekati perhitungan teoritis.

$$
\gamma_3 = \phi_1 \gamma_2 + \phi_2 \gamma_1= 0.5(3.1949) + 0.2(3.3064)
= 1.59745 + 0.66128
= 2.2587
$$
$$
\rho_3 = \frac{\gamma_3}{\gamma_0}=\frac{2.2587}{3.7083} = 0.6094
$$

